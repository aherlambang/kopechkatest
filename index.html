<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Fetcher</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }
        #loading {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Dropdown for Email Provider -->
    <label for="emailProvider">Choose your email provider:</label>
    <select id="emailProvider">
        <option value="gmail.com">Gmail</option>
        <option value="mail.ru">Mail.ru</option>
    </select>

    <!-- Button to Get Email -->
    <button id="getEmailBtn">GET EMAIL</button>

    <!-- Display Email -->
    <div id="emailSection" style="margin-top: 10px;">
        <p>Email: <span id="emailDisplay"></span></p>
        <button id="copyEmailBtn" onclick="copyToClipboard('emailDisplay')" style="display: none;">Copy Email</button>
        <p id="loading">ðŸ”„ Waiting for code...</p>
        <button id="cancelBtn" style="display: none;">CANCEL</button>
    </div>

    <!-- JavaScript to handle interactions -->
    <script>
        let requestId;

        document.getElementById('getEmailBtn').addEventListener('click', function () {
            const emailProvider = document.getElementById('emailProvider').value;
            getEmail(emailProvider);
        });

        function getEmail(mailType) {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('cancelBtn').style.display = 'none';

            fetch(`https://api.kopeechka.store/mailbox-get-email?site=instagram.com&mail_type=${mailType}&token=492cca6f3d079f1b88c7b3eedb35347e`)
                .then(response => response.json())
                .then(data => {
                    const email = data.email;
                    requestId = data.id; // Store the request ID for the cancel function
                    document.getElementById('emailDisplay').textContent = email;
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('copyEmailBtn').style.display = 'inline';
                    document.getElementById('cancelBtn').style.display = 'inline';
                })
                .catch(error => console.error('Error fetching email:', error));
        }

        document.getElementById('cancelBtn').addEventListener('click', function () {
            if (!requestId) return;
            const url = `https://api.kopeechka.store/mailbox-cancel?id=${requestId}&token=492cca6f3d079f1b88c7b3eedb35347e`;
            fetch(url)
                .then(response => response.json())
                .then(data => console.log('Request cancelled:', data))
                .catch(error => console.error('Error cancelling request:', error));
        });

        function copyToClipboard(elementId) {
            const text = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(text)
                .then(() => alert('Copied to clipboard!'))
                .catch(err => console.error('Error copying to clipboard:', err));
        }
    </script>
</body>
</html>
